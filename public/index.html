<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>10MinuteMail — Temporary Email</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
  <style>
    .hero { padding: 80px 0 40px; text-align: center; }
    .hero h1 { margin-bottom: 12px; }
    .hero p { color: var(--text-secondary); font-size: 1.1rem; max-width: 520px; margin: 0 auto 32px; }
    .inbox-panel { max-width: 780px; margin: 0 auto; }
    .email-display {
      display: flex; align-items: center; gap: 12px;
      background: var(--primary-light); border: 2px solid var(--primary);
      border-radius: var(--radius-lg); padding: 16px 20px; margin-bottom: 20px;
    }
    .email-display .email-addr {
      flex: 1; font-family: var(--font-mono); font-size: 1.15rem;
      font-weight: 600; color: var(--primary); user-select: all;
    }
    .inbox-toolbar { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 10px; margin-bottom: 16px; }
    .inbox-info { display: flex; align-items: center; gap: 16px; flex-wrap: wrap; }
    .refresh-indicator { display: flex; align-items: center; gap: 6px; font-size: 0.82rem; color: var(--text-muted); }
    .messages-wrapper { margin-top: 8px; }
    .message-detail-panel {
      background: var(--bg-card); border: 1px solid var(--border);
      border-radius: var(--radius-lg); margin-top: 16px;
    }
    .message-detail-back { margin-bottom: 16px; }
    .body-tabs { display: flex; gap: 4px; margin-bottom: 12px; }
    .body-tab {
      padding: 4px 14px; border-radius: var(--radius); font-size: 0.82rem;
      font-weight: 550; border: 1px solid var(--border); background: var(--bg-input);
      color: var(--text-secondary); cursor: pointer; transition: all var(--transition);
      font-family: inherit;
    }
    .body-tab.active { background: var(--primary); color: #fff; border-color: var(--primary); }
    .text-body-content { white-space: pre-wrap; font-size: 0.9rem; line-height: 1.7; padding: 16px; background: var(--bg-code); border-radius: var(--radius); max-height: 500px; overflow-y: auto; }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar">
    <div class="container">
      <a href="/" class="navbar-brand">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
        </svg>
        10MinuteMail
      </a>
      <div class="nav-links">
        <a href="/admin.html" class="nav-link">Admin</a>
        <a href="/docs" class="nav-link" target="_blank">API Docs</a>
        <button class="nav-link" title="Toggle theme" id="themeToggle">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="4"/><path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32 1.41 1.41M2 12h2m16 0h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></svg>
        </button>
      </div>
    </div>
  </nav>

  <!-- Views container -->
  <main class="container">

    <!-- VIEW: Landing / Create Inbox -->
    <div id="view-landing">
      <div class="hero">
        <h1>Disposable Email, Instantly</h1>
        <p>Get a temporary email address with a short-lived access token. Messages are fetched from real POP3 servers — no setup required.</p>
      </div>

      <div class="inbox-panel">
        <div class="card">
          <div class="tabs">
            <button class="tab active" data-tab="generated" id="tab-btn-generated">Generate Inbox</button>
            <button class="tab" data-tab="external" id="tab-btn-external">Bring Your Own</button>
          </div>

          <!-- Tab: Generated -->
          <div id="tab-generated">
            <p class="text-secondary mb-4">We'll create a random email address instantly. No credentials needed.</p>
            <div class="form-group">
              <label class="form-label">Token lifetime</label>
              <select id="gen-ttl" class="form-select">
                <option value="300">5 minutes</option>
                <option value="600" selected>10 minutes</option>
                <option value="1800">30 minutes</option>
                <option value="3600">1 hour</option>
              </select>
            </div>
            <button class="btn btn-primary btn-lg w-full" id="btn-create-gen">
              Create Temporary Email
            </button>
          </div>

          <!-- Tab: External -->
          <div id="tab-external" class="hidden">
            <p class="text-secondary mb-4">Connect your own POP3 mailbox. Credentials are encrypted and never stored in plaintext.</p>
            <div class="form-group">
              <label class="form-label">Email address</label>
              <input type="email" id="ext-email" class="form-input" placeholder="you@example.com">
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">POP3 Host</label>
                <input type="text" id="ext-host" class="form-input" placeholder="pop.example.com">
              </div>
              <div class="form-group">
                <label class="form-label">POP3 Port</label>
                <input type="number" id="ext-port" class="form-input" value="995" min="1" max="65535">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Username</label>
                <input type="text" id="ext-user" class="form-input" placeholder="your-username">
              </div>
              <div class="form-group">
                <label class="form-label">Password</label>
                <input type="password" id="ext-pass" class="form-input" placeholder="your-password">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">TLS</label>
                <select id="ext-tls" class="form-select">
                  <option value="true" selected>Enabled (recommended)</option>
                  <option value="false">Disabled</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Token lifetime</label>
                <select id="ext-ttl" class="form-select">
                  <option value="300">5 minutes</option>
                  <option value="600" selected>10 minutes</option>
                  <option value="1800">30 minutes</option>
                  <option value="3600">1 hour</option>
                </select>
              </div>
            </div>
            <button class="btn btn-primary btn-lg w-full" id="btn-create-ext">
              Connect Mailbox
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- VIEW: Inbox (messages list) -->
    <div id="view-inbox" class="hidden">
      <div class="inbox-panel" style="margin-top: 32px;">
        <!-- Email display bar -->
        <div class="email-display">
          <span class="email-addr" id="inbox-email">—</span>
          <button class="btn btn-sm btn-secondary copy-btn" id="btn-copy-email">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
            Copy
          </button>
        </div>

        <!-- Toolbar -->
        <div class="inbox-toolbar">
          <div class="inbox-info">
            <div class="timer" id="token-timer">
              <span class="timer-dot"></span>
              <span id="timer-text">10:00</span>
            </div>
            <span class="badge badge-info" id="inbox-type-badge">generated</span>
          </div>
          <div class="flex gap-2">
            <button class="btn btn-sm btn-secondary" id="btn-refresh">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>
              Refresh
            </button>
            <button class="btn btn-sm btn-secondary" id="btn-rotate-token">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48 2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48 2.83-2.83"/></svg>
              Rotate Token
            </button>
            <button class="btn btn-sm btn-danger" id="btn-delete-inbox">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18m-2 0v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6m3 0V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>
              Delete
            </button>
          </div>
        </div>

        <!-- Auto-refresh indicator -->
        <div class="refresh-indicator mb-2">
          <div class="spinner" style="width:12px;height:12px;border-width:1.5px;" id="auto-refresh-spinner" class="hidden"></div>
          <span id="auto-refresh-text">Auto-refresh every 15s</span>
        </div>

        <!-- Messages list -->
        <div class="card messages-wrapper">
          <div id="messages-container">
            <div class="empty-state">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
              <h3>No messages yet</h3>
              <p>New messages will appear here automatically.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- VIEW: Message Detail -->
    <div id="view-message" class="hidden">
      <div class="inbox-panel" style="margin-top: 32px;">
        <button class="btn btn-sm btn-ghost message-detail-back" id="btn-back-inbox">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m15 18-6-6 6-6"/></svg>
          Back to inbox
        </button>
        <div class="message-detail-panel">
          <div class="message-detail" id="message-detail-content"></div>
        </div>
      </div>
    </div>

  </main>

  <!-- Toast container -->
  <div class="toast-container" id="toast-container"></div>

  <script src="/js/app.js"></script>
</body>
</html>
